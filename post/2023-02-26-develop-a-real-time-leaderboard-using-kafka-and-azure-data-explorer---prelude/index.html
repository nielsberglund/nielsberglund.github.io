<!DOCTYPE html>
<html lang="en-us">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    
    <meta property="og:site_name" content="Niels Berglund">
    <meta property="og:type" content="article">

    
    <meta property="og:image" content="https://nielsberglund.com//images/thumbnails/posts/leaderboard-kafka.jpg">
    <meta property="twitter:image" content="https://nielsberglund.com//images/thumbnails/posts/leaderboard-kafka.jpg" />
    

    
    <meta name="title" content="Develop a Real-Time Leaderboard Using Kafka and Azure Data Explorer - Prelude" />
    <meta property="og:title" content="Develop a Real-Time Leaderboard Using Kafka and Azure Data Explorer - Prelude" />
    <meta property="twitter:title" content="Develop a Real-Time Leaderboard Using Kafka and Azure Data Explorer - Prelude" />
    

    
    <meta name="description" content="This post is the first in a series about developing online gaming leaderboards. This post sets the foundation and you use Docker to run Kafka as well as Python in a container generating and publishing events.">
    <meta property="og:description" content="This post is the first in a series about developing online gaming leaderboards. This post sets the foundation and you use Docker to run Kafka as well as Python in a container generating and publishing events." />
    <meta property="twitter:description" content="This post is the first in a series about developing online gaming leaderboards. This post sets the foundation and you use Docker to run Kafka as well as Python in a container generating and publishing events." />
    

    
    <meta property="twitter:card" content="summary" />
    
    

    <meta name="keyword"  content="SQL Server, .NET, Kafka, Streaming, Azure Data Explorer, AI/ML">
    <link rel="shortcut icon" href="/img/favicon.ico">

    <title>Develop a Real-Time Leaderboard Using Kafka and Azure Data Explorer - Prelude | Niels Berglund</title>

    <link rel="canonical" href="/post/2023-02-26-develop-a-real-time-leaderboard-using-kafka-and-azure-data-explorer---prelude/">

    
    
    
    <link rel="stylesheet" href="/css/bootstrap.min.css">

    
    <link rel="stylesheet" href="/css/hugo-theme-cleanwhite.min.css">

    
    <link rel="stylesheet" href="/css/zanshang.css">

    
    <link rel="stylesheet" href="/css/font-awesome.all.min.css">

    
    

    
    <link rel="stylesheet" href="/css/niels-styles.css">

    
    <script src="/js/jquery.min.js"></script>

    
    <script src="/js/bootstrap.min.js"></script>

    
    <script src="/js/hux-blog.min.js"></script>

    
    <script src="/js/lazysizes.min.js"></script>

    
    

    <script defer data-domain="nielsberglund.com" src="https://plausible.io/js/script.file-downloads.outbound-links.js"></script>

</head>






<nav class="navbar navbar-default navbar-custom navbar-fixed-top">

    <div class="container-fluid">
        
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">Niels Berglund</a>
        </div>

        
        
        <div id="huxblog_navbar">
            <div class="navbar-collapse">
                <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="/">All Posts</a>
                    </li>
                    
                    
		    
                        <li><a href="/series//">BLOG SERIES</a></li>
                    
                        <li><a href="/top/about//">ABOUT ME</a></li>
                    
                        <li><a href="/top/archive//">ARCHIVE</a></li>
                    
                        <li><a href="/top/disclaimer//">DISCLAIMER</a></li>
                    
		            <li>
                        <a href="/search"><i class="fa fa-search"></i></a>
		           </li>
                </ul>
            </div>
        </div>
        
    </div>
    
</nav>
<script>
    
    
    
    var $body   = document.body;
    var $toggle = document.querySelector('.navbar-toggle');
    var $navbar = document.querySelector('#huxblog_navbar');
    var $collapse = document.querySelector('.navbar-collapse');

    $toggle.addEventListener('click', handleMagic)
    function handleMagic(e){
        if ($navbar.className.indexOf('in') > 0) {
        
            $navbar.className = " ";
            
            setTimeout(function(){
                
                if($navbar.className.indexOf('in') < 0) {
                    $collapse.style.height = "0px"
                }
            },400)
        }else{
        
            $collapse.style.height = "auto"
            $navbar.className += " in";
        }
    }
</script>




<style type="text/css">
    header.intro-header {
        background-image: url('/images/banner/posts/leaderboard-kafka.jpg')
    }
</style>

<header class="intro-header" >

    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <div class="tags">
                        
                        <a class="tag" href="/tags/azure-data-explorer" title="Azure Data Explorer">
                            Azure Data Explorer
                        </a>
                        
                        <a class="tag" href="/tags/kusto" title="Kusto">
                            Kusto
                        </a>
                        
                        <a class="tag" href="/tags/kql" title="KQL">
                            KQL
                        </a>
                        
                        <a class="tag" href="/tags/kafka" title="Kafka">
                            Kafka
                        </a>
                        
                        <a class="tag" href="/tags/python" title="Python">
                            Python
                        </a>
                        
                    </div>
                    <h1>Develop a Real-Time Leaderboard Using Kafka and Azure Data Explorer - Prelude</h1>
                    <h2 class="subheading"></h2>
                    <span class="meta">
                        
                            Posted by 
                            
                                nielsb
                             
                            on 
                            Sunday, February 26, 2023
                            
                            
                            
                            
                    </span>
                </div>
            </div>
        </div>
    </div>
</header>




<article>
    <div class="container">
        <div class="row">

            
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                post-container">

                
                <p>This blog post series is inspired by my conference talk 

<a href="https://youtu.be/rA3iZlZ8YOw" target="_blank" rel="noopener"><strong>Analyze Billions of Rows of Data in Real-Time Using Azure Data Explorer</strong></a>. Posts in the series are:</p>
<ul>
<li><strong>Develop a Real-Time Leaderboard Using Kafka and Azure Data Explorer - Prelude</strong> (this post)</li>
<li>

<a href="/post/2023-03-19-develop-a-real-time-leaderboard-using-kafka-and-azure-data-explorer---i/"><strong>Develop a Real-Time Leaderboard Using Kafka and Azure Data Explorer - I</strong></a></li>
<li>

<a href="/post/2023-04-03-develop-a-real-time-leaderboard-using-kafka-and-azure-data-explorer---ii/"><strong>Develop a Real-Time Leaderboard Using Kafka and Azure Data Explorer - II</strong></a></li>
</ul>
<p>In the presentation, I talk about &ldquo;user-facing&rdquo; analytics. Historically analytics has been limited to a small set of users in an organization (think the C-suite, power users, etc.). User-facing analytics changes that and makes analytics available to the end-users. An example of &ldquo;user-facing analytics&rdquo; is LinkedIn&rsquo;s: &ldquo;Who&rsquo;s viewed your profile&rdquo;. Another example is leaderboards, which are popular in online gaming.</p>
<p>Since I work for a company (

<a href="/derivco">Derivco</a>) that develops systems for the iGaming industry, this series looks at the basics of a real-time leaderboard for online gaming using Kafka and <strong>Azure Data Explorer</strong> (ADX).</p>
<p>Initially, I thought one post would cover this, but I quickly realized one post covering everything would be way too long. Therefore, I am splitting this topic into multiple posts, and in this post, I look at Kafka and event generation.</p>
<p>Arguably, this first post has little to do with ADX, which is why the title says <strong>Prelude</strong> &#x1f604;. Still, it is important because it sets up the publishing mechanism, which can be reused for anything else you want to do.</p>
<h2 id="pre-reqs">Pre-Reqs</h2>
<p>This section is here to list what you need if you want to follow along:</p>
<ul>
<li>Docker Desktop. We use Docker to &ldquo;spin up&rdquo; containers for Kafka and a Python application. The Python application generates and publishes events to Kafka. Caveat: If you are on an Apple Silicon Mac (M1 or M2), you need Python installed as the container for the event generation application won&rsquo;t build on Apple Silicon. This is because there is no &ldquo;wheel&rdquo; for the Confluent Kafka Python client that installs in an ARM-based container.</li>
</ul>
<p>For this post, the above is the only thing you need. If you want to &ldquo;prep&rdquo; for the follow-up posts you also need this:</p>
<ul>
<li>An Azure account. If you don&rsquo;t have an Azure subscription, sign up for a 

<a href="https://azure.microsoft.com/en-us/free/" target="_blank" rel="noopener">free account</a>.</li>
<li>An Azure Data Explorer cluster. To set up an ADX cluster and a database, look here: 

<a href="https://docs.microsoft.com/en-us/azure/data-explorer/create-cluster-database-portal" target="_blank" rel="noopener">Quickstart: Create an Azure Data Explorer cluster and database</a>. Please note that there may be a cost associated with the ADX cluster, so be sure to tear it down when you are done.</li>
</ul>
<h3 id="code">Code</h3>
<p>The code for this post is in the 

<a href="https://github.com/nielsberglund/leaderboard-prelude" target="_blank" rel="noopener">leaderboard-prelude</a> GitHub repo. To follow along, clone the repo somewhere on your machine.</p>
<p>Having the pre-reqs and the code lets us continue.</p>
<h2 id="user-facing-analytics">User-facing Analytics</h2>
<p>Above I spoke briefly about user-facing analytics, and it doesn&rsquo;t seem that difficult: &ldquo;how hard can it be?&rdquo; &#x1f604;. The difficulty comes when you want to provide users with up-to-date and relevant insights. This requires real-time data processing and analysis. This, in turn, can be challenging to achieve as it requires a robust and scalable infrastructure to handle potentially large numbers of users accessing the analytics simultaneously.</p>
<p>The two last sentences in the paragraph above are the crux: real-time processing and many users. In the iGaming world, you have thousands and thousands of online users simultaneously generating events that need to be handled in real-time. Then these users want access to their data, once again, in real-time.</p>
<p>With the above in mind, you want technologies offering the following:</p>
<ul>
<li>Real-time ingestion of large volumes of data.</li>
<li>Ability to handle thousands and thousands of queries per second.</li>
<li>Low latency (milliseconds).</li>
</ul>
<h2 id="technologies">Technologies</h2>
<p>The technologies chosen for the posts in the series are:</p>
<ul>
<li>Kafka</li>
<li>Azure Data Explorer</li>
</ul>
<p>Kafka is not a surprise as it is the de facto standard for streaming. In the next post, we discuss <strong>Azure Data Explorer</strong> (ADX) and why it is the chosen technology. Knowing you can &ldquo;automagically&rdquo; ingest data from Kafka into ADX using Kafka Connect is enough for now.</p>
<p>Enough of the underlying technology; let us see what to build.</p>
<h2 id="the-online-gaming-event-leaderboard">The Online Gaming Event Leaderboard</h2>
<p>You have been asked to build a leaderboard system for a company that promotes/runs different online games. This company wants to set up promotions/campaigns where each campaign can have its own leaderboard.</p>
<p>When a user plays an online game (think one-armed bandit), each spin generates an event containing information about the spin:</p>
<div class="highlight"><div style="color:#586e75;background-color:#eee8d5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#586e75;background-color:#eee8d5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#586e75;background-color:#eee8d5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#268bd2;font-weight:bold">&#34;playerId&#34;</span>: Int<span style="color:#2aa198;font-weight:bold">32</span>, 
</span></span><span style="display:flex;"><span>  <span style="color:#268bd2;font-weight:bold">&#34;gameId&#34;</span>: Int<span style="color:#2aa198;font-weight:bold">32</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#268bd2;font-weight:bold">&#34;win&#34;</span>: Int<span style="color:#2aa198;font-weight:bold">64</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#268bd2;font-weight:bold">&#34;stake&#34;</span>: Int<span style="color:#2aa198;font-weight:bold">32</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#268bd2;font-weight:bold">&#34;eventTime&#34;</span>: DateTime
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>Code Snippet 1:</strong> <em>Event Schema</em></p>
<p>The fields you see in <em>Code Snippet 1</em> should be self-explanatory. The one field that may not be obvious is <code>stake</code>. That is the value of the spin. When a spin happens, the event is published to a Kafka topic.</p>
<p>In future posts, I will cover more about the design/architecture of the leaderboard. In this post, the architecture looks like so:</p>
<p>
  <img src="/images/posts/leaderboard-kafka.png" alt="">

</p>
<p><strong>Figure 1:</strong> <em>Publishing to Kafka</em></p>
<p>You see the system&rsquo;s flow in <em>Figure 1</em> where the player makes a spin, which generates a spin event. This event is being published to a topic in Kafka.</p>
<h2 id="kafka-and-event-generation">Kafka and Event Generation</h2>
<p>Now is the time to implement what you see in <em>Figure 1</em>:</p>
<ul>
<li>Spin up a Kafka Cluster</li>
<li>Generate events and publish them to Kafka.</li>
</ul>
<p>You do the above using a Docker compose file: <code>docker-compose.yml</code>.</p>
<h3 id="docker-compose-file">Docker Compose File</h3>
<p>You will find the file in the GitHub repo mentioned above in the <code>docker</code> folder:</p>
<div class="highlight"><div style="color:#586e75;background-color:#eee8d5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#586e75;background-color:#eee8d5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#586e75;background-color:#eee8d5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yml" data-lang="yml"><span style="display:flex;"><span><span style="color:#268bd2">---</span>
</span></span><span style="display:flex;"><span><span style="color:#268bd2;font-weight:bold">version</span>: <span style="color:#2aa198">&#39;3&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#268bd2;font-weight:bold">services</span>:
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  <span style="color:#268bd2;font-weight:bold">kafka-ui</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#268bd2;font-weight:bold">container_name</span>: <span style="color:#2aa198">kafka-ui</span>
</span></span><span style="display:flex;"><span>    <span style="color:#268bd2;font-weight:bold">image</span>: <span style="color:#2aa198">provectuslabs/kafka-ui:latest</span>
</span></span><span style="display:flex;"><span>    <span style="color:#268bd2;font-weight:bold">ports</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#2aa198;font-weight:bold">8080</span>:<span style="color:#2aa198;font-weight:bold">8080</span>
</span></span><span style="display:flex;"><span>    [<span style="color:#2aa198">snipped for brevity]</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>  <span style="color:#268bd2;font-weight:bold">zookeeper</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#268bd2;font-weight:bold">image</span>: <span style="color:#2aa198">confluentinc/cp-zookeeper:latest</span>
</span></span><span style="display:flex;"><span>    <span style="color:#268bd2;font-weight:bold">hostname</span>: <span style="color:#2aa198">zookeeper</span>
</span></span><span style="display:flex;"><span>    <span style="color:#268bd2;font-weight:bold">container_name</span>: <span style="color:#2aa198">zookeeper</span>
</span></span><span style="display:flex;"><span>    [<span style="color:#2aa198">snipped for brevity]</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#268bd2;font-weight:bold">broker</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#268bd2;font-weight:bold">image</span>: <span style="color:#2aa198">confluentinc/cp-kafka:latest</span>
</span></span><span style="display:flex;"><span>    <span style="color:#268bd2;font-weight:bold">hostname</span>: <span style="color:#2aa198">broker</span>
</span></span><span style="display:flex;"><span>    <span style="color:#268bd2;font-weight:bold">container_name</span>: <span style="color:#2aa198">broker</span>
</span></span><span style="display:flex;"><span>    [<span style="color:#2aa198">snipped for brevity]</span>
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  <span style="color:#268bd2;font-weight:bold">kafka-init-topics</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#268bd2;font-weight:bold">image</span>: <span style="color:#2aa198">confluentinc/cp-kafka:latest</span>
</span></span><span style="display:flex;"><span>    <span style="color:#268bd2;font-weight:bold">depends_on</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#2aa198">broker</span>
</span></span><span style="display:flex;"><span>    <span style="color:#268bd2;font-weight:bold">command</span>: <span style="color:#2aa198">&#34;bash -c &#39;echo Waiting for Kafka to be ready... &amp;&amp; \
</span></span></span><span style="display:flex;"><span><span style="color:#2aa198">               cub kafka-ready -b broker:29092 1 30 &amp;&amp; \
</span></span></span><span style="display:flex;"><span><span style="color:#2aa198">               kafka-topics --create --topic gameplay --bootstrap-server broker:29092 --partitions 4 --config retention.ms=86400000 &#39;&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#268bd2;font-weight:bold">event-gen</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#268bd2;font-weight:bold">build</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#268bd2;font-weight:bold">context</span>: <span style="color:#2aa198">../</span>
</span></span><span style="display:flex;"><span>      <span style="color:#268bd2;font-weight:bold">dockerfile</span>: <span style="color:#2aa198">./docker/build/Dockerfile</span>
</span></span><span style="display:flex;"><span>    <span style="color:#268bd2;font-weight:bold">hostname</span>: <span style="color:#2aa198">event-gen</span>
</span></span><span style="display:flex;"><span>    <span style="color:#268bd2;font-weight:bold">depends_on</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#2aa198">broker</span>
</span></span><span style="display:flex;"><span>    <span style="color:#268bd2;font-weight:bold">container_name</span>: <span style="color:#2aa198">event-gen</span>
</span></span><span style="display:flex;"><span>    <span style="color:#268bd2;font-weight:bold">command</span>: <span style="color:#2aa198">tail -F /dev/null</span>
</span></span><span style="display:flex;"><span>    <span style="color:#268bd2;font-weight:bold">environment</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#268bd2;font-weight:bold">BOOTSTRAP_SERVERS</span>: <span style="color:#2aa198">&#34;broker:29092&#34;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>Code Snippet 2:</strong> <em>Docker Compose</em></p>
<p>In <em>Code Snippet 2</em>, you see an abbreviated version of the docker compose file. As you see, the compose file spins up containers for a Kafka cluster, with some exceptions:</p>
<ul>
<li><code>kafka-ui</code>: If you need a UI for your Kafka, ksqlDB, etc., cluster, this is a nice UI. Give it a try!</li>
<li><code>kafka-init-topics</code>: This container is used to create a topic(s) in the broker. I use it here to create the topic to which you publish events: <code>gameplay</code>.</li>
</ul>
<p>The third exception is <code>event-gen</code>.</p>
<h2 id="event-generation">Event Generation</h2>
<p>The <code>event-gen</code> container contains a Python application that generates and publishes events to the Kafka topic. Oh, and as you will see in a bit, it also consumes.</p>
<p>As you see in <em>Code Snippet 2</em>, the app is built from a Dockerfile:</p>
<div class="highlight"><div style="color:#586e75;background-color:#eee8d5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#586e75;background-color:#eee8d5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">9
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#586e75;background-color:#eee8d5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>FROM python:3.9.16-slim-bullseye
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>ENV <span style="color:#268bd2">BOOTSTRAP_SERVERS</span> = <span style="color:#2aa198">&#39;localhost:9092&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>COPY ./app/gameplay.py .
</span></span><span style="display:flex;"><span>COPY ./app/runConsumer.py .
</span></span><span style="display:flex;"><span>COPY ./app/runProducer.py .
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>RUN pip install confluent-kafka
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>Code Snippet 3:</strong> <em>Docker File</em></p>
<p>In <em>Code Snippet 3</em>, you see the Docker file used to build the <code>event-gen</code> app. Looking at the file, you see the following:</p>
<ol>
<li>The build is based on a Python Docker image: <code>3.9.16-slim-bullseye</code>, a lightweight version of Python 3.9.16.</li>
<li>I set an environment variable: <code>BOOTSTRAP_SERVERS</code>. The variable points to the bootstrap servers for the Kafka cluster. When looking at the docker compose file in <em>Code Snippet 2</em>, you see how I override that variable to point to the <code>broker</code> container, which is internally available on port <code>29092</code>.</li>
<li>Three Python source files are copied into the container.</li>
<li>Finally, I install the Confluent Kafka Python client into the container.</li>
</ol>
<p>At the beginning of this post, I mentioned a caveat when running this on an Apple Silicon machine, and it is step 4 above that will not work. If you are on an Apple Silicon machine, you need to run the Python application independently. This also means you need to install the Confluent Kafka Python client into your Python installation: <code>pip install confluent-kafka</code>.</p>
<h3 id="application-source-code">Application Source Code</h3>
<p>The source code for the Python application is in the <code>app</code> folder in the cloned repo, and as mentioned above, there are three files:</p>
<ul>
<li><code>gameplay.py</code></li>
<li><code>runConsumer.py</code></li>
<li><code>runProducer.py</code></li>
</ul>
<h4 id="gameplaypy">gameplay.py</h4>
<p>This is the source for generating a game event. When looking at the code, you see it is mostly configuration variables for the number of players, number of games, stake, win, etc. Those variables are then used in the <code>generateGamePlay()</code> function:</p>
<div class="highlight"><div style="color:#586e75;background-color:#eee8d5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#586e75;background-color:#eee8d5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#586e75;background-color:#eee8d5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#859900">def</span> <span style="color:#268bd2">generateGamePlay</span>() :
</span></span><span style="display:flex;"><span>  <span style="color:#268bd2">win</span> = <span style="color:#2aa198;font-weight:bold">0</span>
</span></span><span style="display:flex;"><span>  <span style="color:#268bd2">playerId</span> = <span style="color:#268bd2">random</span>.<span style="color:#268bd2">randint</span>(<span style="color:#268bd2">minPlayerId</span>, <span style="color:#268bd2">maxPlayerId</span>)
</span></span><span style="display:flex;"><span>  <span style="color:#268bd2">gameId</span> = <span style="color:#268bd2">random</span>.<span style="color:#268bd2">randint</span>(<span style="color:#268bd2">minGameId</span>, <span style="color:#268bd2">maxGameId</span>)
</span></span><span style="display:flex;"><span>  <span style="color:#268bd2">stake</span> = <span style="color:#268bd2">random</span>.<span style="color:#268bd2">randint</span>(<span style="color:#268bd2">minStake</span>, <span style="color:#268bd2">maxStake</span>)
</span></span><span style="display:flex;"><span>  <span style="color:#268bd2">eventTime</span> = <span style="color:#268bd2">datetime</span>.<span style="color:#268bd2">datetime</span>.<span style="color:#268bd2">utcnow</span>().<span style="color:#268bd2">strftime</span>(<span style="color:#2aa198">&#34;%Y-%m-</span><span style="color:#2aa198">%d</span><span style="color:#2aa198"> %H:%M:%S.</span><span style="color:#2aa198">%f</span><span style="color:#2aa198">&#34;</span>)
</span></span><span style="display:flex;"><span>  <span style="color:#859900">if</span>((<span style="color:#268bd2">random</span>.<span style="color:#268bd2">randint</span>(<span style="color:#268bd2">minWinIndicator</span>, <span style="color:#268bd2">maxWinIndicator</span>) %  <span style="color:#268bd2">winModulu</span>) == <span style="color:#2aa198;font-weight:bold">0</span> ):
</span></span><span style="display:flex;"><span>    <span style="color:#268bd2">win</span> = <span style="color:#268bd2">random</span>.<span style="color:#268bd2">randint</span>(<span style="color:#268bd2">minWin</span>, <span style="color:#268bd2">maxWin</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#268bd2">retVal</span> = {
</span></span><span style="display:flex;"><span>    <span style="color:#2aa198">&#34;playerId&#34;</span>: <span style="color:#268bd2">playerId</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#2aa198">&#34;gameId&#34;</span>: <span style="color:#268bd2">gameId</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#2aa198">&#34;stake&#34;</span>: <span style="color:#268bd2">stake</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#2aa198">&#34;win&#34;</span>: <span style="color:#268bd2">win</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#2aa198">&#34;eventTime&#34;</span>: <span style="color:#268bd2">eventTime</span>
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#859900">return</span> <span style="color:#268bd2">playerId</span>, <span style="color:#268bd2">json</span>.<span style="color:#268bd2">dumps</span>(<span style="color:#268bd2">retVal</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>Code Snippet 4:</strong> <em>Generate Event</em></p>
<p>You see in <em>Code Snippet 4</em> how the configuration variables are used to randomly assign values to a new event.</p>
<h4 id="runconsumerpy">runConsumer.py</h4>
<p>So, as implied by the name, <code>runConsumer.py</code> is the source for consumption from Kafka. At first, I hadn&rsquo;t planned to include any consumers in the app. Still, it is helpful to check that what is produced actually ends up on the intended topic, so here it is &#x1f604;.</p>
<p>The consumer expects some command line parameters at startup:</p>
<p>
  <img src="/images/posts/leaderboard-adx-consume-params.png" alt="">

</p>
<p><strong>Figure 2:</strong> <em>Consume Parameters</em></p>
<p>In <em>Figure 2</em> you see the parameters you can set. They should be self-explanatory, but maybe I should say a word about <code>-b</code> (<code>--bootstrap</code>). It indicates the bootstrap server to connect to IF you run the application outside of the container. Running the application inside the container, it uses the <code>BOOTSTRAP_SERVERS</code> environment variable.</p>
<h4 id="runproducerpy">runProducer.py</h4>
<p>This is the source for producing messages and publishing them to Kafka. This code calls into <code>gameplay.py</code> to generate an event, and then it publishes it. The producer can run in two &ldquo;modes&rdquo;:</p>
<ul>
<li>Generate events one by one.</li>
<li>Generate events while running in a loop.</li>
</ul>
<p>Whether to generate events one by one or in a loop is defined by startup parameters:</p>
<p>
  <img src="/images/posts/leaderboard-adx-produce-params.png" alt="">

</p>
<p><strong>Figure 3:</strong> <em>Produce Parameters</em></p>
<p>The &ldquo;loop&rdquo; related parameters are: <code>-l</code>, <code>-e</code>, <code>-m</code>, <code>-x</code>, and <code>-n</code>, as seen in <em>Figure 3</em>. The only required parameter for &ldquo;looping&rdquo; is <code>-l</code>; the other &ldquo;loop&rdquo; related parameters have default values. Oh, and the <code>-b</code> (<code>--bootstrap</code>) parameter acts the same as for the consumer.</p>
<h2 id="spin-up-the-containers-and-run">Spin Up the Containers and Run</h2>
<p>Now it is time to put this together and &ldquo;spin up&rdquo; the Kafka cluster with the application to ensure it works. What you first need to do is to <code>cd</code> into the <code>docker</code> folder.</p>
<blockquote>
<p><strong>NOTE:</strong> If you are on Apple Silicon, open the <code>docker-compose.yml</code> file and comment out the <code>event-gen</code> part, as you will run the Python application independently.</p>
</blockquote>
<p>Now you:</p>
<ul>
<li>Ensure that Docker Desktop is up and running.</li>
<li>Spin up the containers: <code>docker compose up -d --build</code>.</li>
</ul>
<p>Having spun up the containers you should see in Docker Desktop something like so:</p>
<p>
  <img src="/images/posts/leaderboard-adx-docker-desktop.png" alt="">

</p>
<p><strong>Figure 4:</strong> <em>Docker Desktop</em></p>
<p>Initially, the status is 5/5 (Apple Silicon 4/4), as in <em>Figure 4</em>. After some seconds, the status will change to 4/5 (Apple 3/4) as the <code>kafka-init-topics</code> container exits after creating the <code>gameplay</code> topic.</p>
<p>To ensure everything is OK, in your browser, you browse: <code>localhost:8080</code>:</p>
<p>
  <img src="/images/posts/leaderboard-adx-kafka-ui.png" alt="">

</p>
<p><strong>Figure 5:</strong> <em>UI for Kafka</em></p>
<p>After opening my browser and browsing to the <strong>UI for Kafka</strong> (<code>localhost:8080</code>), I clicked on the <code>Topics</code> menu to the right (as in <em>Figure 5</em> - outlined in blue). I see one topic in the Kafka cluster, <code>gameplay</code>, outlined in red. All is OK!</p>
<h3 id="publish-and-consume">Publish and Consume</h3>
<p>You are now ready to publish. However, you also want to ensure that what you publish IS published, so you start with &ldquo;spinning up&rdquo; the consumer.</p>
<h4 id="apple-silicon">Apple Silicon</h4>
<p>Before we look at consuming (and publishing): the instructions below assume running the application container. If you are on Apple Silicon, you have to run the application independently.</p>
<p>So instead of executing the Python scripts from the container (see below), you <code>cd</code> into the <code>app</code> folder and run the scripts from there.</p>
<h4 id="consuming">Consuming</h4>
<p>To start the consumer, you need to <code>docker exec</code> into the <code>event-gen</code> container and in there, execute <code>runConsumer.py</code>:</p>
<p>
  <img src="/images/posts/leaderboard-adx-exec-consumer.png" alt="">

</p>
<p><strong>Figure 6:</strong> <em>Run Consumer</em></p>
<p>In <em>Figure 6</em> you see:</p>
<ul>
<li>Launch a <code>bash</code> terminal in the <code>event-gen</code> container (outlined in blue).</li>
<li>After launching the terminal, you execute the Python script (outlined in red).</li>
</ul>
<p>Part of executing the Python script is sending in the topic startup parameter (<code>-t</code>): <code>gameplay</code>.</p>
<p>The consumer is now up and running.</p>
<h4 id="publishing">Publishing</h4>
<p>Time to publish:</p>
<p>
  <img src="/images/posts/leaderboard-adx-exec-publish.png" alt="">

</p>
<p><strong>Figure 7:</strong> <em>Generate and Publish Events</em></p>
<p>As in <em>Figure 7</em>, publishing events looks similar to consuming events. The only difference is you execute <code>runPublisher.py</code> instead of <code>runConsumer.py</code>. As you are not looping, you click <code>Y</code> to produce and publish an event.</p>
<p>After generating and publishing an event, you should see the same event appearing in the consuming application:</p>
<p>
  <img src="/images/posts/leaderboard-adx-exec-consumer-2.png" alt="">

</p>
<p><strong>Figure 8:</strong> <em>Consumed Event</em></p>
<p>Yay, it works! In <em>Figure 8</em> you see how the consuming application has received an event (outlined in red) looking suspiciously similar to the event published in <em>Figure 7</em>.</p>
<blockquote>
<p><strong>NOTE:</strong> When you want to exit either the publisher or consumer, follow the instructions in the terminal and then <code>exit</code> to exit out of the container.</p>
</blockquote>
<p>Having confirmed it all works, you can now &ldquo;play around&rdquo; with the startup parameters for the publisher and see how looping works:</p>
<p>
  <img src="/images/posts/leaderboard-adx-exec-loop.png" alt="">

</p>
<p><strong>Figure 9:</strong> <em>Publish in a Loop</em></p>
<p>Above, in <em>Figure 3</em>, I mentioned the startup parameters for the publisher and what is used for looping. In <em>Figure 9</em> you see the usage:</p>
<ul>
<li><code>-t</code>: You should know about <code>-t</code> by now: the topic to publish to.</li>
<li><code>-l</code>: You explicitly set <code>-l</code> when you want to &ldquo;loop&rdquo;.</li>
<li><code>-e</code>: The number of events to generate. I.e. the number of loops. In this case, you want to generate 100 events.</li>
<li><code>-m</code>: The minimum latency between events is 10 milliseconds.</li>
<li><code>-x</code>: Maximum latency is 50 ms.</li>
<li><code>-p</code>: Every tenth event generated is printed. The first event is always printed.</li>
</ul>
<p>You now have a &ldquo;framework&rdquo; for generating and publishing events to Kafka.</p>
<h4 id="tear-down">Tear Down</h4>
<p>When you are finished, tear down everything by exiting out of the publish and consume applications and then do <code>docker compose down</code> in the location where <code>docker-compose.yml</code> is.</p>
<h2 id="summary">Summary</h2>
<p>As mentioned above, this post is a prelude to coming posts covering creating an online gaming leaderboard using Kafka and Azure Data Explorer.</p>
<p>This post gave you the foundation for future posts:</p>
<ul>
<li>Spinning up a Kafka cluster in Docker.</li>
<li>In that cluster, having a container which publishes and consumes events.</li>
</ul>
<p>That&rsquo;s it for now. Look out for future posts in this series.</p>
<h2 id="-finally">~ Finally</h2>
<p>If you have comments, questions etc., please comment on this post or [ping][ma] me.</p>

                

                
                <hr>
                <ul class="pager">
                    
                    <li class="previous">
                        <a href="/post/2023-02-19-interesting-stuff---week-7-2023/" data-toggle="tooltip" data-placement="top" title="Interesting Stuff - Week 7, 2023">&larr;
                            Previous Post</a>
                    </li>
                    
                    
                    <li class="next">
                        <a href="/post/2023-02-26-interesting-stuff---week-8-2023/" data-toggle="tooltip" data-placement="top" title="Interesting Stuff - Week 8, 2023">Next
                            Post &rarr;</a>
                    </li>
                    
                </ul>
                

                


<div id="disqus-comment"></div>
<div id="disqus_thread"></div>
<script>
    window.disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "manageddata" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>


            </div>

            
            
            <div class="
                col-lg-2 col-lg-offset-0
                visible-lg-block
                sidebar-container
                catalog-container">
                <div class="side-catalog">
                    <hr class="hidden-sm hidden-xs">
                    <h5>
                        <a class="catalog-toggle" href="#">CATALOG</a>
                    </h5>
                    <ul class="catalog-body"></ul>
                </div>
            </div>
            

            
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                sidebar-container">

                
                

                
                
            </div>
        </div>
    </div>
</article>




<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">                  
                    
                    <li>
                        <a href="mailto:niels.it.berglund@gmail.com">
                            <span class="fa-stack fa-lg">
                                <i class="fas fa-circle fa-stack-2x"></i>
                                <i class="fas fa-envelope fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
		           
                    
                    <li>
                        <a href="https://twitter.com/nielsberglund">
                            <span class="fa-stack fa-lg">
                                <i class="fas fa-circle fa-stack-2x"></i>
                                <i class="fab fa-twitter fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    
                    

		            
                    
                    
                    <li>
                        <a target="_blank" href="https://github.com/nielsberglund">
                            <span class="fa-stack fa-lg">
                                <i class="fas fa-circle fa-stack-2x"></i>
                                <i class="fab fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
		            
                    
                    
                    
                    <li>
                        <a target="_blank" href="https://www.linkedin.com/in/niels-berglund-0122593">
                            <span class="fa-stack fa-lg">
                                <i class="fas fa-circle fa-stack-2x"></i>
                                <i class="fab fa-linkedin fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
		           
                    
                    <li>
                        <a target="_blank" href="https://medium.com/@nielsberglund">
                            <span class="fa-stack fa-lg">
                                <i class="fas fa-circle fa-stack-2x"></i>
                                <i class="fab fa-medium fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li>
                        <a target="_blank" href="https://stackoverflow.com/users/7656880/niels-berglund">
                            <span class="fa-stack fa-lg">
                                <i class="fas fa-circle fa-stack-2x"></i>
                                <i class="fab fa-stack-overflow fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    
                    
                    <li>
                        <a target="_blank" href="https://fosstodon.org/@nielsb">
                            <span class="fa-stack fa-lg">
                                <i class="fas fa-circle fa-stack-2x"></i>
                                <i class="fab fa-mastodon fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
            
            
            
           
           <li>
             <a target="_blank" href="https://nielsberglund.com/index.xml">
                <span class="fa-stack fa-lg">
                    <i class="fas fa-circle fa-stack-2x"></i>
                    <i class="fas fa-rss fa-stack-1x fa-inverse"></i>
                </span>
             </a>
           </li>
           
             </ul>
		<p class="copyright text-muted">
                    Copyright &copy; Niels Berglund 2025
                    <br>
                    <a href="https://themes.gohugo.io/hugo-theme-cleanwhite">CleanWhite Hugo Theme</a> by <a href="https://zhaohuabing.com">Huabing</a> |
                    <iframe
                        style="margin-left: 2px; margin-bottom:-5px;"
                        frameborder="0" scrolling="0" width="100px" height="20px"
                        src="https://ghbtns.com/github-btn.html?user=zhaohuabing&repo=hugo-theme-cleanwhite&type=star&count=true" >
                    </iframe>
                </p>
            </div>
        </div>
    </div>
</footer>




<script>
    function loadAsync(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>






<script>
    
    if($('#tag_cloud').length !== 0){
        loadAsync("/js/jquery.tagcloud.js",function(){
            $.fn.tagcloud.defaults = {
                
                color: {start: '#bbbbee', end: '#0085a1'},
            };
            $('#tag_cloud a').tagcloud();
        })
    }
</script>


<script>
    loadAsync("https://cdn.jsdelivr.net/npm/fastclick@1.0.6/lib/fastclick.min.js", function(){
        var $nav = document.querySelector("nav");
        if($nav) FastClick.attach($nav);
    })
</script>






<script type="text/javascript">
    function generateCatalog(selector) {

        
        
        
        
            _containerSelector = 'div.post-container'
        

        
        var P = $(_containerSelector), a, n, t, l, i, c;
        a = P.find('h1,h2,h3,h4,h5,h6');

        
        $(selector).html('')

        
        a.each(function () {
            n = $(this).prop('tagName').toLowerCase();
            i = "#" + $(this).prop('id');
            t = $(this).text();
            c = $('<a href="' + i + '" rel="nofollow">' + t + '</a>');
            l = $('<li class="' + n + '_nav"></li>').append(c);
            $(selector).append(l);
        });
        return true;
    }

    generateCatalog(".catalog-body");

    
    $(".catalog-toggle").click((function (e) {
        e.preventDefault();
        $('.side-catalog').toggleClass("fold")
    }))

    


    loadAsync("\/js\/jquery.nav.js", function () {
        $('.catalog-body').onePageNav({
            currentClass: "active",
            changeHash: !1,
            easing: "swing",
            filter: "",
            scrollSpeed: 700,
            scrollOffset: 0,
            scrollThreshold: .2,
            begin: null,
            end: null,
            scrollChange: null,
            padding: 80
        });
    });
</script>






</body>
</html>
